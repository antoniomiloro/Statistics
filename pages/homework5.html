<!DOCTYPE html>
<html>
    <head>
        <title>Statistics</title>
        <meta http-equiv='cache-control' content='no-cache'> 
        <meta http-equiv='expires' content='0'> 
        <meta http-equiv='pragma' content='no-cache'>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <style>
            #servers {
                display: flex;
            }
            .server {
                width: 2px;
                height: 100px;
                background-color: #3498db; /* Colore delle linee degli attacchi */
                margin: 0 1px;
                opacity: 0.5; /* Opacità per una visualizzazione più chiara */
            }
        </style>
    </head>
    <body>
        <h1>Esercizio 1</h1>
        <h5>M servers are subject to attacks during a period of time T (for instance 1 year). <br>
            Subdivide the interval T in N subinterval of size T/N and in each of this suppose that
            an attack can occur with probability λ T/N. <br>
            Simulate the attacks to the M servers and represent each of them with a line which
            makes jumps of 1 at each attack event.</h5>
        
        <div class="centered">
            <p>
                <label for="M"> <b>Number of systems (M):</b></label>
                <input type="number" id="M" value="5" min="1">
            </p>
            <p>
                <label for="N"><b>Number of attacks (N):</b></label>
                <input type="number" id="N" value="10" min="1"> 
            </p>
            <p>
                <label for="T"><b>Time period (T):</b></label>
                <input type="number" id="T" value="1" min="1" max="365"> 
            </p>
        </div>

        <button onclick="startSimulation()">Start Simulation</button>
        <br> <br>
        <div id="servers"></div>

        <script>
            let M, N, T, lambda;
            let servers = [];

            function startSimulation() {
                M = parseInt(document.getElementById('M').value);
                N = parseInt(document.getElementById('N').value);
                T = parseInt(document.getElementById('T').value);

                servers = Array(M).fill(0);
                lambda = 1 / (N * T); // Adjust as needed

                const simulationInterval = setInterval(simulateAttacks, 1000); // Every second

                setTimeout(() => {
                    clearInterval(simulationInterval);
                }, T * 1000); // Convert T to milliseconds
            }

            function simulateAttacks() {
                for (let i = 0; i < M; i++) {
                    if (Math.random() < lambda) {
                        servers[i]++;
                    }
                }
                updateServerDisplay();
            }

            function updateServerDisplay() {
                const serverContainer = document.getElementById('servers');
                serverContainer.innerHTML = '';

                for (let i = 0; i < M; i++) {
                    const serverDiv = document.createElement('div');
                    serverDiv.className = 'server';
                    serverDiv.style.height = (servers[i] * 10) + 'px'; // Scale for visibility
                    serverContainer.appendChild(serverDiv);
                }
            }
        </script>

    </body>